
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>dtw3m</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-08-29"><meta name="DC.source" content="dtw3m_help.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>dtw3m</h1><!--introduction--><p>Pure m-file implementation of DTW (dynamic time warping) with local paths of 0 and 45 degrees</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example</a></li><li><a href="#8">See Also</a></li></ul></div><h2>Syntax<a name="1"></a></h2><div><ul><li>minDist = dtw3m(vec1, vec2)</li><li>minDist = dtw3m(vec1, vec2, beginCorner, endCorner)</li><li>minDist = dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt)</li><li>minDist = dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt, distanceBound)</li><li>[minDist, dtwPath, dtwTable] = dtw3m(...)</li></ul></div><h2>Description<a name="2"></a></h2><p>
<p>dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt, distanceBound) returns the DTW distance between vec1 and vec2, assuming a local path constrains of 0 and 45 degrees.
	<ul>
	<li>vec1: testing vector
	<li>vec2: reference vector
	<li>beginCorner: 1 for anchored beginning
	<li>endCorner: 1 for anchored ending
	<li>plotOpt: 1 for plotting the DTW path
	<li>distanceBound: distance bound for stop the computation. (Stop the computation immediately if the accumulated DTW distance is larger than this distance bound.)
	</ul>
<p>[minDist, dtwPath, dtwTable] = dtw3m(...) also return two extra results:
	<ul>
	<li>dtwPath: optimal path of DTW (Its size is 2xk, where k is the path length.)
	<li>dtwTable: DTW table
	</ul>
<p>Note that this function is a pure m-file implementation which is slow but easy to customize.
</p><h2>Example<a name="3"></a></h2><p>This example aligns a singing pitch to a note sequence</p><pre class="codeinput">pv=[47.485736 48.330408 48.917323 49.836778 50.478049 50.807818 50.478049 50.807818 50.478049 49.836778 50.154445 49.836778 50.154445 50.478049 49.524836 52.930351 52.930351 52.930351 52.558029 52.193545 51.836577 51.836577 51.836577 52.558029 52.558029 52.930351 52.558029 52.193545 51.836577 51.486821 49.218415 48.330408 48.621378 48.917323 49.836778 50.478049 50.478049 50.154445 50.478049 50.807818 50.807818 50.154445 50.154445 50.154445 54.505286 55.349958 55.349958 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.349958 55.349958 54.505286 54.505286 54.922471 55.788268 55.788268 56.237965 55.788268 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 54.922471 54.922471 54.097918 49.218415 49.218415 48.917323 49.218415 49.836778 50.478049 50.478049 50.154445 49.836778 50.154445 49.524836 49.836778 49.524836 55.788268 53.699915 53.699915 53.310858 53.310858 53.310858 53.310858 52.930351 52.930351 52.930351 52.930351 52.930351 52.558029 52.193545 51.486821 50.154445 49.836778 49.836778 50.154445 50.478049 50.478049 50.154445 49.836778 49.836778 49.524836 49.524836 49.524836 56.699654 57.661699 58.163541 58.163541 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 58.163541 57.173995 56.699654 56.237965 55.788268 56.237965 56.699654 56.699654 56.237965 55.788268 56.237965 56.237965 56.237965 56.237965 56.237965 56.237965 56.237965 55.788268 54.097918 50.154445 50.154445 50.478049 51.143991 51.143991 50.807818 50.154445 51.143991 50.154445 50.478049 50.807818 50.478049 60.330408 61.524836 62.154445 62.807818 62.807818 62.807818 62.807818 62.807818 63.486821 63.486821 63.486821 63.486821 62.807818 62.807818 61.524836 59.213095 58.163541 58.680365 59.213095 59.762739 59.762739 59.762739 59.762739 59.762739 59.762739];
note=[60 29 60 10 62 38 60 38 65 38 64 77 60 29 60 10 62 38 60 38 67 38 65 77 60 29 60 10 72 38 69 38 65 38 64 38 62 77 0 77 70 29 70 10 69 38 65 38 67 38 65 38];
pv=pv+13;
notePitch=note(1:2:end);		<span class="comment">% Get pitch only</span>
notePitch(notePitch==0)=[];		<span class="comment">% Get rid of rests</span>
[minDist, dtwPath] = dtw3m(pv, notePitch, 1, 0);
dtwPathPlot(pv, notePitch, dtwPath, <span class="string">'square'</span>);
</pre><img vspace="5" hspace="5" src="dtw3m_help_01.png" alt=""> <p>This example performs quantization over output of a discriminant function for learning to rank</p><pre class="codeinput">DS=prData(<span class="string">'ltr1d'</span>);		<span class="comment">% 1D dataset for learning to rank (LTR)</span>
[minDist, dtwPath] = dtw3m(DS.output, min(DS.output):max(DS.output), 1, 1);
figure; dtwPathPlot(DS.output, min(DS.output):max(DS.output), dtwPath, <span class="string">'square'</span>);
title([<span class="string">'DP total distance = '</span>, num2str(minDist)]);
</pre><img vspace="5" hspace="5" src="dtw3m_help_02.png" alt=""> <p>Plot the dataset and the cut points for LTR</p><pre class="codeinput">index=find(diff(dtwPath(2,:)));
cutPoints=(DS.input(index)+DS.input(index+1))/2;
figure; dsProjPlot1(DS);
minY=min(DS.output)-1;
maxY=max(DS.output)+1;
axis([-inf inf minY maxY]);
<span class="keyword">for</span> i=1:length(cutPoints)
	line(cutPoints(i)*[1 1], [minY, maxY]);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="dtw3m_help_03.png" alt=""> <p>Re-evaluate to create the squared errors</p><pre class="codeinput"><span class="keyword">for</span> i=1:length(DS.output)
	computed(i)=find(diff(DS.input(i)&lt;[-inf cutPoints inf]));
<span class="keyword">end</span>
squareError=sum((DS.output-computed).^2)
</pre><pre class="codeoutput">
squareError =

    21

</pre><h2>See Also<a name="8"></a></h2><p><a href="dtwPathPlot_help.html">dtwPathPlot</a>, <a href="dtwBridgePlot_help.html">dtwBridgePlot</a>, <a href="dtw1_help.html">dtw1</a>, <a href="dtw2_help.html">dtw2</a>, <a href="dtw3_help.html">dtw3</a>.</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% dtw3m
% Pure m-file implementation of DTW (dynamic time warping) with local paths of 0 and 45 degrees
%% Syntax
% * 		minDist = dtw3m(vec1, vec2)
% * 		minDist = dtw3m(vec1, vec2, beginCorner, endCorner)
% * 		minDist = dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt)
% * 		minDist = dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt, distanceBound)
% * 		[minDist, dtwPath, dtwTable] = dtw3m(...)
%% Description
%
% <html>
% <p>dtw3m(vec1, vec2, beginCorner, endCorner, plotOpt, distanceBound) returns the DTW distance between vec1 and vec2, assuming a local path constrains of 0 and 45 degrees.
% 	<ul>
% 	<li>vec1: testing vector
% 	<li>vec2: reference vector
% 	<li>beginCorner: 1 for anchored beginning
% 	<li>endCorner: 1 for anchored ending
% 	<li>plotOpt: 1 for plotting the DTW path
% 	<li>distanceBound: distance bound for stop the computation. (Stop the computation immediately if the accumulated DTW distance is larger than this distance bound.)
% 	</ul>
% <p>[minDist, dtwPath, dtwTable] = dtw3m(...) also return two extra results:
% 	<ul>
% 	<li>dtwPath: optimal path of DTW (Its size is 2xk, where k is the path length.)
% 	<li>dtwTable: DTW table
% 	</ul>
% <p>Note that this function is a pure m-file implementation which is slow but easy to customize.
% </html>
%% Example
%%
% This example aligns a singing pitch to a note sequence
pv=[47.485736 48.330408 48.917323 49.836778 50.478049 50.807818 50.478049 50.807818 50.478049 49.836778 50.154445 49.836778 50.154445 50.478049 49.524836 52.930351 52.930351 52.930351 52.558029 52.193545 51.836577 51.836577 51.836577 52.558029 52.558029 52.930351 52.558029 52.193545 51.836577 51.486821 49.218415 48.330408 48.621378 48.917323 49.836778 50.478049 50.478049 50.154445 50.478049 50.807818 50.807818 50.154445 50.154445 50.154445 54.505286 55.349958 55.349958 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.788268 55.349958 55.349958 54.505286 54.505286 54.922471 55.788268 55.788268 56.237965 55.788268 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 55.349958 54.922471 54.922471 54.097918 49.218415 49.218415 48.917323 49.218415 49.836778 50.478049 50.478049 50.154445 49.836778 50.154445 49.524836 49.836778 49.524836 55.788268 53.699915 53.699915 53.310858 53.310858 53.310858 53.310858 52.930351 52.930351 52.930351 52.930351 52.930351 52.558029 52.193545 51.486821 50.154445 49.836778 49.836778 50.154445 50.478049 50.478049 50.154445 49.836778 49.836778 49.524836 49.524836 49.524836 56.699654 57.661699 58.163541 58.163541 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 57.661699 58.163541 57.173995 56.699654 56.237965 55.788268 56.237965 56.699654 56.699654 56.237965 55.788268 56.237965 56.237965 56.237965 56.237965 56.237965 56.237965 56.237965 55.788268 54.097918 50.154445 50.154445 50.478049 51.143991 51.143991 50.807818 50.154445 51.143991 50.154445 50.478049 50.807818 50.478049 60.330408 61.524836 62.154445 62.807818 62.807818 62.807818 62.807818 62.807818 63.486821 63.486821 63.486821 63.486821 62.807818 62.807818 61.524836 59.213095 58.163541 58.680365 59.213095 59.762739 59.762739 59.762739 59.762739 59.762739 59.762739];
note=[60 29 60 10 62 38 60 38 65 38 64 77 60 29 60 10 62 38 60 38 67 38 65 77 60 29 60 10 72 38 69 38 65 38 64 38 62 77 0 77 70 29 70 10 69 38 65 38 67 38 65 38];
pv=pv+13;
notePitch=note(1:2:end);		% Get pitch only
notePitch(notePitch==0)=[];		% Get rid of rests
[minDist, dtwPath] = dtw3m(pv, notePitch, 1, 0);
dtwPathPlot(pv, notePitch, dtwPath, 'square');
%%
% This example performs quantization over output of a discriminant function for learning to rank
DS=prData('ltr1d');		% 1D dataset for learning to rank (LTR)
[minDist, dtwPath] = dtw3m(DS.output, min(DS.output):max(DS.output), 1, 1);
figure; dtwPathPlot(DS.output, min(DS.output):max(DS.output), dtwPath, 'square');
title(['DP total distance = ', num2str(minDist)]);
%%
% Plot the dataset and the cut points for LTR
index=find(diff(dtwPath(2,:)));
cutPoints=(DS.input(index)+DS.input(index+1))/2;
figure; dsProjPlot1(DS);
minY=min(DS.output)-1;
maxY=max(DS.output)+1;
axis([-inf inf minY maxY]);
for i=1:length(cutPoints)
	line(cutPoints(i)*[1 1], [minY, maxY]);
end
%%
% Re-evaluate to create the squared errors
for i=1:length(DS.output)
	computed(i)=find(diff(DS.input(i)<[-inf cutPoints inf]));
end
squareError=sum((DS.output-computed).^2)
%% See Also
% <dtwPathPlot_help.html dtwPathPlot>,
% <dtwBridgePlot_help.html dtwBridgePlot>,
% <dtw1_help.html dtw1>,
% <dtw2_help.html dtw2>,
% <dtw3_help.html dtw3>.

##### SOURCE END #####
--><hr><a href="index.html">Top page</a>&nbsp;&nbsp;&nbsp;Next: <a href="dtw3_help.html">dtw3.m</a>&nbsp;&nbsp;&nbsp;Prev:<a href="dtw3withRestM_help.html">dtw3withRestM.m</a>
<script>
function keyFunction(){
if (event.keyCode==37) document.location="dtw3_help.html";
if (event.keyCode==39) document.location="dtw3withRestM_help.html";
if (event.keyCode==69) document.location="matlab: edit dtw3m.m";
}
document.onkeydown=keyFunction;
</script>
</body></html>
